# Optimizator Next Gen

**Optimizator Next Gen** — десктопное приложение для глубокой и гибкой оптимизации шаблонов документов. Оно позволяет автоматизировать очистку, форматирование и модификацию файлов `*.docx` и `*.fdt` через настраиваемый, управляемый из конфигурационного файла конвейер обработки.

## Ключевые концепции

Проект построен на нескольких ключевых архитектурных принципах:

1.  **Единый источник истины (`config.json`)**: Вся логика обработки, настройки и даже метаданные для UI определяются в одном конфигурационном файле. Это позволяет изменять поведение приложения без перекомпиляции кода.
2.  **Максимальная атомизация**: Каждая операция (например, "удалить отступы" или "заменить цвет") является независимой, "атомарной" функцией со своим собственным тестом. Это обеспечивает надежность и гибкость конвейера.
3.  **Динамический UI**: Пользовательский интерфейс не захардкожен, а динамически генерируется на основе содержимого `config.json`, что упрощает добавление нового функционала.
4.  **Трехуровневая архитектура**:
    - **Оболочка (Shell)**: Графический интерфейс на базе Electron (`index.html`, `renderer.ts`, `preload.ts`), отвечающий за взаимодействие с пользователем.
    - **Оркестратор (Orchestrator)**: Главный процесс Electron (`main.ts`), который управляет окном, читает `config.json` и запускает конвейер обработки в ответ на действия пользователя.
    - **Ядро (Core)**: Набор чистых, атомарных TypeScript-функций (`src/core/steps/*.ts`), которые выполняют всю работу по модификации XML-содержимого документов.

## Стек технологий

- **Фреймворк:** Electron
- **Язык:** TypeScript
- **Тестирование:** Jest
- **Среда выполнения:** Node.js
- **Система контроля версий:** Git (GitHub)

## Установка и запуск

1.  **Клонируйте репозиторий:**

    ```bash
    git clone https://github.com/AlexanderKuzikov/OptimizatorNG.git
    cd OptimizatorNG
    ```

2.  **Установите зависимости:**

    ```bash
    npm install
    ```

3.  **Запустите приложение:**
    ```bash
    npm start
    ```
    Эта команда автоматически скомпилирует TypeScript-код в папку `dist/` и запустит Electron-приложение.

## Как это работает

При запуске приложение читает `config.json` и строит интерфейс, группируя все доступные шаги обработки по целевым файлам (`word/document.xml`, `word/styles.xml` и т.д.).

1.  Вы можете включать или отключать любой шаг с помощью чекбоксов.
2.  Нажмите кнопку **"Выбрать файлы и запустить обработку"**.
3.  Откроется системный диалог для выбора одного или нескольких `*.docx` файлов.
4.  После выбора файлов "Оркестратор" последовательно применит все включенные "атомы" к каждому документу.
5.  Лог обработки и количество произведенных замен будут выводиться в реальном времени в текстовое поле внизу окна.
6.  Обработанные файлы будут сохранены в папке `OUT/` в той же директории, где находятся исходные файлы.
