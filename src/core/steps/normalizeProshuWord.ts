interface StepResult {
  xml: string;
  changes: number;
}

/**
 * Заменяет все вхождения слова "ПРОШУ" на "Прошу" в тексте документа (XML).
 * Использует регулярное выражение для глобальной замены.
 *
 * @param xml - Входящая XML-строка word/document.xml.
 * @param params - Параметры (не используются в данной функции).
 * @returns Объект с обновленной XML-строкой и количеством произведенных замен.
 */
export function normalizeProshuWord(xml: string, params: any): StepResult {
  if (!xml || xml.trim() === '') return { xml: '', changes: 0 };

  // Используем глобальное регулярное выражение с флагом 'g' для всех вхождений
  // и флагом 'i' для игнорирования регистра, чтобы поймать "прошу", "ПРОШУ", "Прошу" и т.д.
  // Но заменяем только "ПРОШУ" на "Прошу"
  // Проще всего сделать замену по всему тексту, и считать изменения
  // Для более точной замены (только если "ПРОШУ" именно капсом), можно использовать \bПРОШУ\b
  // Но так как задача просто заменить слово, сделаем по простому
  
  const oldXml = xml;
  // Заменяем все вхождения "ПРОШУ" (регистронезависимо) на "Прошу"
  // Проверяем, было ли изменено что-либо, чтобы корректно посчитать changes
  const newXml = oldXml.replace(/ПРОШУ/g, 'Прошу');

  const changes = (oldXml.match(/ПРОШУ/g) || []).length;

  return { xml: newXml, changes: changes };
}